"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[614],{86709:function(e,r,t){t.d(r,{A:function(){return c},q:function(){return b}});var l=t(52322),a=t(27617),o=t(95380),u=t(92526),n=t(2784);let i={id:"",characters:[],title:"",description:"",users:[],permissions:[],last_updated:0,visibility:"",settings:{anyone_can_join:!1,require_approval:!1,join_token:"",character_limit:u.jr.MAX_CHARACTERS_LEN,user_limit:u.jr.MAX_USERS_LEN,auto_smart_reply:!1,smart_reply_timer:!1},picture:"",preview_turns:[]},s=n.createContext({invokeCarouselVisible:[!1,()=>a.ws],messageOptionsPayload:[void 0,()=>a.ws],moderationPayload:[void 0,()=>a.ws],editMessagePayload:[void 0,()=>a.ws],autoplaySetting:[!1,()=>a.ws],chatRoom:i,isLoadingRooms:!0}),c=e=>{var r;let{children:t,roomId:a}=e,[u,c]=(0,n.useState)(!0),[b,d]=(0,n.useState)(!1),[h,g]=(0,n.useState)(),[m,C]=(0,n.useState)(),[p,f]=(0,n.useState)(),{chatRooms:v,isLoading:B}=(0,o.W7)(),x=null!==(r=v[a])&&void 0!==r?r:i;return(0,l.jsx)(s.Provider,{value:{invokeCarouselVisible:[u,c],messageOptionsPayload:[h,g],moderationPayload:[m,C],editMessagePayload:[p,f],autoplaySetting:[b,d],chatRoom:x,isLoadingRooms:B},children:t})},b=()=>(0,n.useContext)(s)},98208:function(e,r,t){t.d(r,{Z:function(){return o}});var l=t(17380),a=t(19206);function o(e){let r=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(r){let{data:r}=l.h.character.infoCached.useQuery({externalId:e},{enabled:!!e,cacheTime:a.yV,staleTime:a.yV,refetchInterval:a.yV});return{info:null!=r?r:null}}let{data:t}=l.h.character.info.useQuery({externalId:e},{enabled:!!e});return{info:null!=t?t:null}}},60614:function(e,r,t){t.d(r,{RJ:function(){return L},vX:function(){return A},Kx:function(){return K},Bo:function(){return E},ax:function(){return P},io:function(){return R},OF:function(){return F},bh:function(){return G},a3:function(){return M},NS:function(){return O},qw:function(){return q},qM:function(){return I}});var l=t(44460),a=t(71126);t(39005);let o=(e,r)=>{let t=e.match(/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/);return t?"rgba(".concat(t[1],", ").concat(t[2],", ").concat(t[3],", ").concat(r,")"):e};var u=t(22094),n=t(566),i=t(86709),s=t(99732),c=t(25854),b=t(25706),d=t(27617),h=t(48461),g=t(19206),m=t(47584),C=t(2236),p=t(5813),f=t(75658),v=t(92262),B=t(41332),x=t(7329),y=t(54504),_=t(10399),T=t(24991),k=t(82876),S=t(2784),w=t(98614),N=t(1876),j=t(15584);let E=()=>{let{subscribeChatEvents:e}=(0,C.m)(),[r,t]=(0,S.useState)(!1);return(0,S.useEffect)(()=>{let r=e(p.qN.unrecoverable_error,()=>{t(!0)});return()=>{r()}},[e]),{unrecoverableErrorOccurred:r}},M=e=>{let{setInputText:r}=e,{t}=(0,w.$G)(),l=(0,k.useSearchParams)(),[a,o]=(0,S.useState)(!1),u=(0,S.useMemo)(()=>{let e=null==l?void 0:l.get("questionKey"),r=null==l?void 0:l.get("index"),a=null==l?void 0:l.get("icebreaker");if(e&&null!=r){let l=(0,m.fN)(e,Number(r));if(T.default.exists(l))return t(l)}else if(a)return a},[l,t]);return{resolveExampleChatPrompt:(0,S.useCallback)(()=>{!a&&u&&u&&(r(u),o(!0))},[u,a,o,r])}},P=()=>{let e=(0,j.BF)(b.AR),r=(0,j.BF)(b.x6);e&&(r=g.l2.dense);let t=r===g.l2.default;return{isDefaultChatStyle:t,isDenseChatStyle:r===g.l2.dense,isChatClassicStyle:r===g.l2.classic,leftAlign:!t}},R=()=>{let{t:e}=(0,w.$G)(),{subscribeChatEvents:r}=(0,C.m)();(0,S.useEffect)(()=>{let t=r(p.qN.websocket_error,(r,t)=>{Number(t.error_code)===f.dw.TooManyPins.errorCode&&Number(t.sub_code)===f.dw.TooManyPins.subCode&&(0,u.K)(e("Chat.max-pin-limit-reached"),void 0,"destructive")});return()=>{t()}},[r,e])},q=(e,r)=>{let{character:t}=(0,v.XS)(null!=e?e:""),{subscribe:l}=(0,C.m)(),[a,o]=(0,S.useState)(null),[u,n]=(0,S.useState)("waiting"),[i,s]=(0,S.useState)(null),[c,b]=(0,S.useState)(),[d,m]=(0,S.useState)(),f=(0,S.useRef)({});(0,S.useEffect)(()=>{t&&m((0,h.bW)(t))},[t]),(0,S.useEffect)(()=>{if(!e||!t)return;let{unsubscribe:a}=l(e,(e,r)=>{let t=(0,h.nx)(e,r);null!=t?(o(t.candidate_id),e.length>0&&(0,h.Gd)(e[0],t)?n("waiting"):n(t.is_final?"none":"streaming")):(o(null),n("none")),e.length>0?s(e[0].turn_key.chat_id):s(null),b(e),f.current=r},p.Em.Neo,{externalHistoryId:r,character:t});return a},[e,l,r,t]);let B=(0,S.useMemo)(()=>d&&c&&c.length<g.L4?[...c,d]:c,[c,d]),x=1-((null==t?void 0:t.greeting)?0:1),y=!!B&&B.length>=1&&!!t,_=y&&B.length===x;return{primaryCandidateId:a,streamingStatus:u,chatId:i,chatTurns:c,processedTurns:B,primaryCandidateMap:f.current,introMessage:d,showLoading:_,chatReady:y}},I=e=>{let{subscribe:r,chatManagerInitialized:t}=(0,C.m)(),[l,a]=(0,S.useState)(null),[o,u]=(0,S.useState)("waiting"),[n,s]=(0,S.useState)(null),[c,b]=(0,S.useState)(),[d]=(0,S.useState)(),{chatRoom:m}=(0,i.q)(),f=(0,S.useRef)({});(0,S.useEffect)(()=>{if(!e||!t)return;let{unsubscribe:l}=r(e,(e,r)=>{let t=(0,h.nx)(e,r);null!=t?(a(t.candidate_id),e.length>0&&(0,h.Gd)(e[0],t)?u("waiting"):u(t.is_final?"none":"streaming")):(a(null),u("none")),e.length>0?s(e[0].turn_key.chat_id):s(null),e.map(e=>(e.author.avatar_url||(e.author.avatar_url=(0,_.EY)(e.author,m)),e.context_reset&&(e.clientSystemMessage={message:"",messageType:y.lo.context_reset}),e)),b(e),f.current=r},p.Em.Room);return l},[e,r,t,m]);let v=(0,S.useMemo)(()=>d&&c&&c.length<g.L4?[...c,d]:c,[c,d]),B=!!v&&v.length>=1,x=B&&0===v.length;return{primaryCandidateId:l,streamingStatus:o,chatId:n,chatTurns:c,processedTurns:v,primaryCandidateMap:f.current,introMessage:d,showLoading:x,chatReady:B}},O=e=>{let{characterId:r,chatId:t,endTurnId:o}=e,{t:n}=(0,w.$G)(),i=(0,N.Z)(),{mutate:s}=(0,B.b3)();return(0,S.useCallback)(()=>{(0,u.K)(n("Chat.do-not-leave-page")),s({chatId:t,endTurnId:o},{onSuccess:e=>{l.iN.characterSelected({referrer:"CopyChatOption",characterId:r,newHistory:!1,action:"copy_chat"});let t="".concat(i.origin).concat(d.nN.chat(r,"hist=".concat(e.new_chat_id,"&duplicate=success")));window.open(t,"_blank")},onError:e=>{var r,t;(0,a.H)("Failed to copy chat",{error:e}),(null==e?void 0:null===(t=e.response)||void 0===t?void 0:null===(r=t.data)||void 0===r?void 0:r.error_code)===f.dw.TooManyMessagesToCopy.errorCode?(0,u.K)(n("Chat.too-many-messages-to-duplicate"),2500,"destructive"):(0,u.K)(n("Common.generic-error"),2500,"destructive")}})},[i,t,o,r,n,s])},G=()=>{let e=(0,k.useRouter)(),r=(0,k.useSearchParams)(),[t,l]=(0,S.useState)(!1),{t:a}=(0,w.$G)(),o=(0,k.usePathname)();(0,S.useEffect)(()=>{if(t||(null==r?void 0:r.get("duplicate"))!=="success")return;(0,u.K)(a("Chat.duplicate-chat-started")),l(!0);let n=new URLSearchParams(r);n.delete("duplicate"),e.replace("".concat(o).concat(n?"?".concat(n.toString()):""))},[t,r,a,e,o])},K=e=>{var r;let t=(0,c.G)(),l=x.I[null!=e?e:""],{userBubbleColor:a,userTextColor:u,characterBubbleColor:i,characterTextColor:b}=null!==(r=t?null==l?void 0:l.darkTheme:null==l?void 0:l.lightTheme)&&void 0!==r?r:{},{isPlusUser:d}=(0,n.a)(),h=(0,s.M)(),g=(0,S.useMemo)(()=>e?{userChatColorOverride:o(a,.9),characterChatColorOverride:o(i,.85),userTextColorOverride:u,characterTextColorOverride:b}:{},[e,a,i,u,b]);return h&&d?g:{}},L=e=>{let{isPlusUser:r}=(0,n.a)();return(0,B.RJ)(e,r)},A=()=>{var e,r;let{chat:t}=L((0,j.BF)(b.jN));return null!==(r=K(null==t?void 0:null===(e=t.metadata)||void 0===e?void 0:e.color_scheme_id))&&void 0!==r?r:{}},F=()=>{var e;let r=(0,s.M)(),{chat:t}=L(b.jN.value),l=null==t?void 0:null===(e=t.metadata)||void 0===e?void 0:e.background_image_url;return{hasCustomBackground:!!l&&!!r,backgroundImageURL:l}}},47584:function(e,r,t){t.d(r,{ZI:function(){return g},fN:function(){return d}});var l=t(52322),a=t(38837),o=t(68741),u=t(80783),n=t(62593),i=t(94766),s=t(98208),c=t(27617),b=t(98614);let d=(e,r)=>"Feed.ExampleChats.".concat(e,".q").concat(r),h=e=>{let{name:r,src:t,creatorUsername:i,numInteractions:s,questionKey:h,characterId:g,upvotes:m}=e,{t:C}=(0,b.$G)();return(0,l.jsxs)("div",{className:"flex flex-col gap-2 p-4 items-start bg-surface-elevation-1 rounded-spacing-s w-[412px]",children:[(0,l.jsxs)("div",{className:"flex flex-row gap-3 items-center",children:[(0,l.jsx)(a.B7,{name:r,size:48,src:t}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-md-medium",children:r}),(0,l.jsxs)("span",{className:"flex flex-row gap-1 text-muted-foreground text-sm",children:[(0,l.jsx)(o.f,{author:i,createdBy:!1}),(0,l.jsx)(u.k,{type:"interactions",num:s,withPrecedingDot:!0}),!!m&&(0,l.jsx)(u.k,{type:"upvotes",num:m,withPrecedingDot:!0})]})]})]}),(0,l.jsx)("div",{className:"w-full flex flex-col gap-1",children:[...[,,,].keys()].map(e=>C(d(h,e))).map((e,r)=>{let t=c.nN.chat(g,new URLSearchParams({questionKey:h,index:r.toString()}).toString());return(0,l.jsx)(n.Z,{className:"w-full rounded-spacing-s p-3 bg-surface-elevation-2 hover:bg-scrim-8",href:t,analytics:{name:"linkHandled",properties:{link:t,referrer:"ExampleChatsCard",type:e}},children:(0,l.jsx)("p",{className:"line-clamp-1 text-ellipsis text-primary text-md",children:e})},"".concat(g,"-example-").concat(r))})})]})},g=e=>{let{characterId:r,questionKey:t}=e,{info:a}=(0,s.Z)(r);if(!a||!a.character||!a.character.name)return(0,l.jsx)(i.O,{className:"h-[230px] w-[412px] rounded-spacing-s"});let{character:o}=a,{name:u,avatar_file_name:n,user__username:c,participant__num_interactions:b,upvotes:d}=o;return(0,l.jsx)(h,{name:u,src:n,creatorUsername:c,numInteractions:b,upvotes:d,questionKey:t,characterId:r})}},7329:function(e,r,t){t.d(r,{I:function(){return l}});let l={red:{id:"red",lightTheme:{userBubbleColor:"rgb(255, 161, 173)",characterBubbleColor:"rgb(250, 230, 233)"},darkTheme:{userBubbleColor:"rgb(159, 45, 60)",characterBubbleColor:"rgb(41, 33, 34)"}},peach:{id:"peach",lightTheme:{userBubbleColor:"rgb(245, 150, 142)",characterBubbleColor:"rgb(245, 200, 191)"},darkTheme:{userBubbleColor:"rgb(249, 106, 93)",characterBubbleColor:"rgb(51, 43, 41)",userTextColor:"rgb(34, 34, 34)"}},clay:{id:"clay",lightTheme:{userBubbleColor:"rgb(204, 172, 129)",characterBubbleColor:"rgb(245, 236, 225)"},darkTheme:{userBubbleColor:"rgb(79, 45, 0)",characterBubbleColor:"rgb(31, 28, 24)"}},honey:{id:"honey",lightTheme:{userBubbleColor:"rgb(245, 208, 157)",characterBubbleColor:"rgb(255, 242, 224)"},darkTheme:{userBubbleColor:"rgb(153, 89, 0)",characterBubbleColor:"rgb(41, 37, 33)"}},yellow:{id:"yellow",lightTheme:{userBubbleColor:"rgb(245, 230, 157)",characterBubbleColor:"rgb(250, 247, 230)"},darkTheme:{userBubbleColor:"rgb(255, 213, 5)",characterBubbleColor:"rgb(56, 47, 0)",userTextColor:"rgb(34, 34, 34)"}},green:{id:"green",lightTheme:{userBubbleColor:"rgb(158, 245, 157)",characterBubbleColor:"rgb(220, 250, 220)"},darkTheme:{userBubbleColor:"rgb(10, 104, 8)",characterBubbleColor:"rgb(42, 61, 42)"}},pine:{id:"pine",lightTheme:{userBubbleColor:"rgb(160, 250, 223)",characterBubbleColor:"rgb(235, 255, 249)"},darkTheme:{userBubbleColor:"rgb(0, 82, 57)",characterBubbleColor:"rgb(42, 61, 55)"}},aqua:{id:"aqua",lightTheme:{userBubbleColor:"rgb(157, 245, 245)",characterBubbleColor:"rgb(227, 250, 250)"},darkTheme:{userBubbleColor:"rgb(0, 127, 127)",characterBubbleColor:"rgb(42, 61, 61)"}},blue:{id:"blue",lightTheme:{userBubbleColor:"rgb(157, 195, 245)",characterBubbleColor:"rgb(225, 236, 250)"},darkTheme:{userBubbleColor:"rgb(20, 100, 204)",characterBubbleColor:"rgb(42, 50, 61)"}},indigo:{id:"indigo",lightTheme:{userBubbleColor:"rgb(157, 195, 245)",characterBubbleColor:"rgb(225, 225, 245)"},darkTheme:{userBubbleColor:"rgb(77, 77, 191)",characterBubbleColor:"rgb(49, 49, 61)"}},purple:{id:"purple",lightTheme:{userBubbleColor:"rgb(215, 157, 245)",characterBubbleColor:"rgb(246, 229, 255)"},darkTheme:{userBubbleColor:"rgb(77, 77, 191)",characterBubbleColor:"rgb(55, 42, 61)"}},silver:{id:"silver",lightTheme:{userBubbleColor:"rgb(201, 200, 204)",characterBubbleColor:"rgb(237, 237, 237)"},darkTheme:{userBubbleColor:"rgb(227, 226, 230)",characterBubbleColor:"rgb(61, 61, 61)",userTextColor:"rgb(34, 34, 34)"}},grey:{id:"grey",lightTheme:{userBubbleColor:"rgb(115, 115, 115)",characterBubbleColor:"rgb(255, 255, 255)",userTextColor:"rgb(255, 255, 255)"},darkTheme:{userBubbleColor:"rgb(42, 44, 46)",characterBubbleColor:"rgb(77, 77, 77)"}},black:{id:"black",lightTheme:{userBubbleColor:"rgb(0, 0, 0)",characterBubbleColor:"rgb(255, 255, 255)",userTextColor:"rgb(255, 255, 255)"},darkTheme:{userBubbleColor:"rgb(0, 0, 0)",characterBubbleColor:"rgb(61, 61, 61)"}}}}}]);