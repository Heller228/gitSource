"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[549],{8883:function(e,t,a){a.d(t,{m:function(){return b}});var r=a(52322),l=a(2784),n=a(8799),o=a(76193),s=a(23279),i=a(90122),d=a(27617),u=a(39097),c=a.n(u),f=a(98614),p=a(11885);let m=["description","definition"],v=e=>{let{character:t}=e,{t:a}=(0,f.$G)(),l=e=>{d.Wj.copyTextToClipboard(null!=e?e:"",a("Common.message-copied-to-clipboard"),"ChatMessage")};return(0,r.jsx)("div",{className:"h-full overflow-y-auto w-full flex flex-col gap-2 pb-2",children:m.map(e=>t[e]?(0,r.jsxs)("div",{className:"h-fit max-h-full flex flex-col gap-2",children:[(0,r.jsxs)("div",{className:"flex flex-row justify-between items-center",children:[(0,r.jsx)("p",{children:a("CharacterEditor.Form.".concat(e))}),(0,r.jsx)(s.zx,{onPress:()=>l(t[e]),variant:"ghost",size:"sm",startContent:(0,r.jsx)(i.TI,{height:"1rem"}),analytics:{name:"elementClicked",properties:{type:"copy-".concat(e),referrer:"ViewCharacterSheet"}},children:a("Common.copy")})]}),(0,r.jsx)("p",{className:"text-sm whitespace-pre-line",children:t[e]})]},e):null)})},h=l.forwardRef((e,t)=>{let{character:a}=e,{t:n}=(0,f.$G)(),[o,d]=(0,l.useState)(!1);return(0,r.jsxs)(p.yo,{onOpenChange:d,open:o,modal:!1,children:[(0,r.jsx)("div",{className:"w-full",children:(0,r.jsx)(s.zx,{variant:"ghost",className:"w-full flex flex-row justify-between rounded-spacing-xs",onPress:()=>{d(!0)},endContent:(0,r.jsx)(i.tE,{width:"1rem",height:"1rem"}),children:n("Common.view-character-details")})}),(0,r.jsxs)(p.ue,{className:"flex h-full flex-col w-96 max-w-80",ref:t,children:[(0,r.jsx)(p.sw,{children:(0,r.jsxs)(p.Tu,{className:"flex flex-row items-center gap-6",children:[(0,r.jsx)(i.XC,{className:"text-muted-foreground size-4"}),n("Common.view-character-details")]})}),(0,r.jsx)(v,{character:a})]})]})});h.displayName="ViewCharacterSheet";let g=l.forwardRef((e,t)=>{let{characterId:a}=e,{t:l}=(0,f.$G)();return(0,r.jsx)(c(),{href:d.nN.character(a),children:(0,r.jsxs)("div",{ref:t,className:"p-2 px-3 w-full flex justify-between items-center bg-surface-elevation-3 hover:bg-[--transparency-4] text-primary rounded-spacing-s",children:[l("Common.edit"),(0,r.jsx)(i.dY,{width:"1rem",height:"1rem"})]})})});g.displayName="EditOption";let x=e=>{let{thisIsMyCharacter:t,character:a}=e;return(0,l.useMemo)(()=>{let e=[];return t&&e.push({content:(0,r.jsx)(g,{characterId:a.external_id}),asChild:!0,key:"edit"}),a.copyable&&m.map(e=>!!a[e]).some(Boolean)&&!t&&e.push({content:(0,r.jsx)(h,{character:a}),asChild:!0,key:"view"}),e},[t,a])},b=e=>{let{thisIsMyCharacter:t,character:a,alwaysShow:i,contentClassName:d}=e,u=x({character:a,thisIsMyCharacter:t}),[c,f]=(0,l.useState)(!1);return u.length?(0,r.jsx)(o.C,{options:u,setIsOpen:f,isOpen:c,triggerClassName:i?"opacity-100":"",contentClassName:d,asChild:!0,children:(0,r.jsx)(s.zx,{variant:i?"outline":"ghost",color:"secondary",isIconOnly:!0,preventDefault:!0,onPress:()=>f(!c),children:(0,r.jsx)(n.evw,{})})}):null}},949:function(e,t,a){a.d(t,{o:function(){return d}});var r=a(52322),l=a(27617),n=a(60711),o=a(98614),s=a(90122),i=a(23279);let d=e=>{let{characterId:t}=e,a=(0,n.Z)(),{t:d}=(0,o.$G)();return(0,r.jsx)(i.zx,{"aria-label":d("Common.share"),isIconOnly:!0,variant:"outline",onPress:()=>a(l.nN.chat(t),"Character"),children:(0,r.jsx)(s.aA,{className:"size-4 text-muted-foreground"})})}},30388:function(e,t,a){a.d(t,{hv:function(){return y}});var r,l,n=a(52322),o=a(44460),s=a(71126),i=a(17063),d=a(27617),u=a(36850),c=a(92262),f=a(30538),p=a(13964),m=a(2784),v=a(98614),h=a(90122),g=a(76727),x=a(98577),b=a(22094);(r=l||(l={})).like="like",r.dislike="dislike";let w={like:!0,dislike:!1},y=e=>{var t;let{characterId:a,hideNum:r,disabled:l,type:i}=e,{t:d}=(0,v.$G)(),{character:h}=(0,c.XS)(null!=a?a:""),{data:g}=(0,p.eq)(a),{votedUp:x,votedDown:y}=(0,m.useMemo)(()=>({votedUp:!!(null==g?void 0:g.voted)&&!!(null==g?void 0:g.vote),votedDown:!!(null==g?void 0:g.voted)&&!(null==g?void 0:g.vote)}),[null==g?void 0:g.voted,null==g?void 0:g.vote]),C=(0,m.useMemo)(()=>x?"like":y?"dislike":void 0,[x,y]),{mutate:j}=(0,p.kP)(),k=(0,f.NL)();return(0,n.jsx)(N,{value:C,onValueChange:e=>{let t=C===e?null:e;j({characterId:a,vote:t?w[t]:null},{onSuccess:()=>{o.iN.userSocialAction({referrer:"CharacterVote",type:"vote",characterId:a,voteType:t||""}),k.invalidateQueries(u.Hc.info.keys(a))},onError:e=>{(0,b.K)(d("Error.something-went-wrong"),void 0,"destructive"),(0,s.H)("Failed to vote",{error:e})}})},upvotes:null!==(t=null==h?void 0:h.upvotes)&&void 0!==t?t:0,hideNum:r,disabled:l,type:i})},N=e=>{let{value:t,onValueChange:a,upvotes:r,hideNum:l,disabled:o,type:s}=e,{t:u}=(0,v.$G)(),c="small"===s?"12px":"16px";return(0,n.jsxs)(x.t,{disabled:o,type:"single",value:t,onValueChange:e=>a(e),className:"border-1 rounded-spacing-l border-surface-elevation-2 h-fit w-fit",children:[(0,n.jsxs)(x.G,{value:"like","aria-label":u("Common.like"),className:(0,i.cn)("data-[state=on]:bg-transparent p-0 h-fit hover:bg-transparent flex flex-row gap-1 group/like","small"===s?"py-1 pl-2":"py-3 pl-3"),children:[(0,n.jsx)(h.eL,{height:c,className:(0,i.cn)("group-hover/like:text-muted-foreground text-icon-secondary",{hidden:"like"!==t})}),(0,n.jsx)(h.lb,{height:c,className:(0,i.cn)("group-hover/like:text-muted-foreground text-icon-secondary",{hidden:"like"===t})}),!l&&!!r&&(0,d.HN)(r)]}),(0,n.jsx)(g.Z,{orientation:"vertical",className:"h-5 mx-1 p-0"}),(0,n.jsxs)(x.G,{value:"dislike","aria-label":u("Common.dislike"),className:(0,i.cn)("data-[state=on]:bg-transparent p-0 h-fit hover:bg-transparent group/dislike","small"===s?"py-1 pr-2":"py-3 pr-3"),children:[(0,n.jsx)(h.C$,{height:c,className:(0,i.cn)("group-hover/like:text-muted-foreground text-icon-secondary",{hidden:"dislike"!==t})}),(0,n.jsx)(h.kZ,{height:c,className:(0,i.cn)("group-hover/like:text-muted-foreground text-icon-secondary",{hidden:"dislike"===t})})]})]})}},11885:function(e,t,a){a.d(t,{Tu:function(){return m},sw:function(){return d},ue:function(){return p},yo:function(){return i}});var r=a(52322),l=a(70241),n=a(10929),o=a(2784),s=a(17063);let i=l.fC;l.xz;let d=l.x8,u=l.h_,c=o.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(l.aV,{className:(0,s.cn)("fixed inset-0 z-50 bg-scrim data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...n,ref:t})});c.displayName=l.aV.displayName;let f=(0,n.j)("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500 data-[state=open]:animate-in data-[state=closed]:animate-out",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l border-l-accent data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right max-w-xs"}},defaultVariants:{side:"right"}}),p=o.forwardRef((e,t)=>{let{side:a="right",className:n,children:o,...i}=e;return(0,r.jsxs)(u,{children:[(0,r.jsx)(c,{}),(0,r.jsx)(l.VY,{ref:t,className:(0,s.cn)(f({side:a}),n),...i,children:o})]})});function m(e){let{className:t,...a}=e;return(0,r.jsx)("div",{className:(0,s.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...a})}p.displayName=l.VY.displayName,m.displayName="SheetHeader",o.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(l.Dx,{ref:t,className:(0,s.cn)("text-lg font-semibold text-foreground",a),...n})}).displayName=l.Dx.displayName,o.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(l.dk,{ref:t,className:(0,s.cn)("text-sm text-muted-foreground",a),...n})}).displayName=l.dk.displayName},98577:function(e,t,a){a.d(t,{t:function(){return c},G:function(){return f}});var r=a(52322),l=a(6992),n=a(2784),o=a(95683),s=a(10929),i=a(17063);let d=(0,s.j)("text-sm inline-flex items-center justify-center rounded-md font-medium ring-offset-background transition-colors data-[state=on]:bg-accent data-[state=on]:text-accent-foreground hover:bg-accent hover:text-primary focus-visible:outline-none disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground"},size:{default:"h-10 px-3",sm:"h-9 px-2.5",lg:"h-11 px-5"}},defaultVariants:{variant:"default",size:"default"}});n.forwardRef((e,t)=>{let{className:a,variant:l,size:n,...s}=e;return(0,r.jsx)(o.f,{ref:t,className:(0,i.cn)(d({variant:l,size:n,className:a})),...s})}).displayName=o.f.displayName;let u=n.createContext({size:"default",variant:"default"}),c=n.forwardRef((e,t)=>{let{className:a,variant:n,size:o,children:s,...d}=e;return(0,r.jsx)(l.fC,{ref:t,className:(0,i.cn)("flex items-center justify-center gap-1",a),...d,children:(0,r.jsx)(u.Provider,{value:{variant:n,size:o},children:s})})});c.displayName=l.fC.displayName;let f=n.forwardRef((e,t)=>{let{className:a,children:o,variant:s,size:c,...f}=e,p=n.useContext(u);return(0,r.jsx)(l.ck,{ref:t,className:(0,i.cn)(d({variant:p.variant||s,size:p.size||c}),a),...f,children:o})});f.displayName=l.ck.displayName},13964:function(e,t,a){a.d(t,{Ft:function(){return p},Os:function(){return u},QJ:function(){return h},Sz:function(){return s},bu:function(){return d},eq:function(){return m},hO:function(){return c},kP:function(){return v},qY:function(){return f},xS:function(){return i}});var r=a(2784),l=a(61569),n=a(36850),o=a(30538);let s={user:["user"],publicUser:e=>[...s.user,"public",e],publicFollowers:e=>[...s.user,"public","followers",e],publicFollowing:e=>[...s.user,"public","following",e],followers:()=>[...s.user,"followers"],following:()=>[...s.user,"following"],votedFor:e=>[...s.user,"voted-for",e],votes:e=>["votes",e],upvotesByCharacter:e=>["upvotes-by-character",e],upvotedCharacters:()=>[...s.user,"upvoted-characters"]},i=(e,t)=>{let a=(0,o.aM)({queryKey:s.publicUser(e),queryFn:async()=>t?(await (0,l.o)().post("/chat/anon/user/public/",{username:e})).data.public_user:(await (0,l.o)().post("/chat/user/public/",{username:e})).data.public_user,staleTime:1/0});return{user:a.data,...a}},d=()=>{let e=(0,o.aM)({queryKey:s.following(),queryFn:async()=>(await (0,l.o)().get("/chat/user/following/")).data.following,staleTime:1/0});return{following:e.data,...e}},u=()=>{let e=(0,o.NL)();return(0,o.Db)(async e=>{let{username:t,requesterUsername:a}=e;return{...(await (0,l.o)().post("/chat/user/follow/",{username:t})).data,username:t,requesterUsername:a}},{onSuccess:t=>{let{username:a,requesterUsername:r}=t;e.invalidateQueries(s.following()),r&&(e.invalidateQueries(s.publicFollowing(r)),e.invalidateQueries(s.publicUser(r))),e.invalidateQueries(s.publicUser(a)),e.invalidateQueries(s.publicFollowers(a))}})},c=()=>{let e=(0,o.NL)();return(0,o.Db)(async e=>{let{username:t,requesterUsername:a}=e;return{...(await (0,l.o)().post("/chat/user/unfollow/",{username:t})).data,username:t,requesterUsername:a}},{onSuccess:t=>{let{username:a,requesterUsername:r}=t;e.invalidateQueries(s.following()),r&&(e.invalidateQueries(s.publicFollowing(r)),e.invalidateQueries(s.publicUser(r))),e.invalidateQueries(s.publicUser(a)),e.invalidateQueries(s.publicFollowers(a))}})},f=e=>{var t;let a=(0,o.NS)(s.publicFollowers(e),async t=>{let{pageParam:a}=t;return e?(await (0,l.o)().post("/chat/user/public/followers/",{username:e,pageParam:null!=a?a:1})).data:{users:[],has_next_page:!1,meta:{}}},{getNextPageParam:(e,t)=>e.has_next_page?t.length+1:void 0,staleTime:1/0}),n=(0,r.useMemo)(()=>{var e,t,r;return(null!==(r=null===(t=a.data)||void 0===t?void 0:null===(e=t.pages)||void 0===e?void 0:e.flatMap(e=>e.users))&&void 0!==r?r:[]).filter(e=>!!(null==e?void 0:e.username))},[null===(t=a.data)||void 0===t?void 0:t.pages]);return{...a,users:n}},p=e=>{var t;let a=(0,o.NS)(s.publicFollowing(e),async t=>{let{pageParam:a}=t;return e?(await (0,l.o)().post("/chat/user/public/following/",{username:e,pageParam:null!=a?a:1})).data:{users:[],has_next_page:!1,meta:{}}},{getNextPageParam:(e,t)=>e.has_next_page?t.length+1:void 0,staleTime:1/0}),n=(0,r.useMemo)(()=>{var e,t,r;return(null!==(r=null===(t=a.data)||void 0===t?void 0:null===(e=t.pages)||void 0===e?void 0:e.flatMap(e=>e.users))&&void 0!==r?r:[]).filter(e=>!!(null==e?void 0:e.username))},[null===(t=a.data)||void 0===t?void 0:t.pages]);return{...a,users:n}},m=e=>{var t,a;let r=(0,o.aM)({queryKey:s.votedFor(e),queryFn:async()=>(await (0,l.o)().get("/chat/character/".concat(e,"/voted/"))).data,staleTime:1/0});return{voted:null===(t=r.data)||void 0===t?void 0:t.voted,vote:null===(a=r.data)||void 0===a?void 0:a.vote,...r}},v=()=>{let e=(0,o.NL)();return(0,o.Db)(async e=>{let{characterId:t,vote:a}=e;return{...(await (0,l.o)().post("/chat/character/vote/",{external_id:t,vote:a})).data,characterId:t}},{onSuccess:t=>{e.invalidateQueries(s.votes(t.characterId)),e.invalidateQueries(s.votedFor(t.characterId)),e.invalidateQueries(s.upvotedCharacters()),e.invalidateQueries(n.Hc.info.keys(t.characterId))}})},h=e=>{let t=(0,o.aM)({queryKey:s.upvotedCharacters(),queryFn:async()=>(await (0,l.o)().get("/chat/user/characters/upvoted/")).data.characters,staleTime:1/0,enabled:!e});return{characters:t.data,...t}}},6992:function(e,t,a){a.d(t,{ck:function(){return T},fC:function(){return _}});var r=a(7896),l=a(2784),n=a(92211),o=a(72714),s=a(2923),i=a(95683),d=a(87695),u=a(59241);let c="ToggleGroup",[f,p]=(0,n.b)(c,[s.Pc]),m=(0,s.Pc)(),v=l.forwardRef((e,t)=>{let{type:a,...n}=e;if("single"===a)return l.createElement(x,(0,r.Z)({},n,{ref:t}));if("multiple"===a)return l.createElement(b,(0,r.Z)({},n,{ref:t}));throw Error(`Missing prop \`type\` expected on \`${c}\``)}),[h,g]=f(c),x=l.forwardRef((e,t)=>{let{value:a,defaultValue:n,onValueChange:o=()=>{},...s}=e,[i,u]=(0,d.T)({prop:a,defaultProp:n,onChange:o});return l.createElement(h,{scope:e.__scopeToggleGroup,type:"single",value:i?[i]:[],onItemActivate:u,onItemDeactivate:l.useCallback(()=>u(""),[u])},l.createElement(N,(0,r.Z)({},s,{ref:t})))}),b=l.forwardRef((e,t)=>{let{value:a,defaultValue:n,onValueChange:o=()=>{},...s}=e,[i=[],u]=(0,d.T)({prop:a,defaultProp:n,onChange:o}),c=l.useCallback(e=>u((t=[])=>[...t,e]),[u]),f=l.useCallback(e=>u((t=[])=>t.filter(t=>t!==e)),[u]);return l.createElement(h,{scope:e.__scopeToggleGroup,type:"multiple",value:i,onItemActivate:c,onItemDeactivate:f},l.createElement(N,(0,r.Z)({},s,{ref:t})))}),[w,y]=f(c),N=l.forwardRef((e,t)=>{let{__scopeToggleGroup:a,disabled:n=!1,rovingFocus:i=!0,orientation:d,dir:c,loop:f=!0,...p}=e,v=m(a),h=(0,u.gm)(c),g={role:"group",dir:h,...p};return l.createElement(w,{scope:a,rovingFocus:i,disabled:n},i?l.createElement(s.fC,(0,r.Z)({asChild:!0},v,{orientation:d,dir:h,loop:f}),l.createElement(o.WV.div,(0,r.Z)({},g,{ref:t}))):l.createElement(o.WV.div,(0,r.Z)({},g,{ref:t})))}),C="ToggleGroupItem",j=l.forwardRef((e,t)=>{let a=g(C,e.__scopeToggleGroup),n=y(C,e.__scopeToggleGroup),o=m(e.__scopeToggleGroup),i=a.value.includes(e.value),d=n.disabled||e.disabled,u={...e,pressed:i,disabled:d},c=l.useRef(null);return n.rovingFocus?l.createElement(s.ck,(0,r.Z)({asChild:!0},o,{focusable:!d,active:i,ref:c}),l.createElement(k,(0,r.Z)({},u,{ref:t}))):l.createElement(k,(0,r.Z)({},u,{ref:t}))}),k=l.forwardRef((e,t)=>{let{__scopeToggleGroup:a,value:n,...o}=e,s=g(C,a),d={role:"radio","aria-checked":e.pressed,"aria-pressed":void 0},u="single"===s.type?d:void 0;return l.createElement(i.Z,(0,r.Z)({},u,o,{ref:t,onPressedChange:e=>{e?s.onItemActivate(n):s.onItemDeactivate(n)}}))}),_=v,T=j},95683:function(e,t,a){a.d(t,{Z:function(){return i},f:function(){return d}});var r=a(7896),l=a(2784),n=a(17998),o=a(87695),s=a(72714);let i=(0,l.forwardRef)((e,t)=>{let{pressed:a,defaultPressed:i=!1,onPressedChange:d,...u}=e,[c=!1,f]=(0,o.T)({prop:a,onChange:d,defaultProp:i});return(0,l.createElement)(s.WV.button,(0,r.Z)({type:"button","aria-pressed":c,"data-state":c?"on":"off","data-disabled":e.disabled?"":void 0},u,{ref:t,onClick:(0,n.M)(e.onClick,()=>{e.disabled||f(!c)})}))}),d=i}}]);