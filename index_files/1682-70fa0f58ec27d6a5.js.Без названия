"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1682],{61682:function(e,t,s){s.d(t,{sQ:function(){return S},mI:function(){return _},mp:function(){return M}});var a=s(52322),r=s(25706),n=s(15584),l=s(23279),i=s(17380),o=s(82427),u=s(18978);let d=e=>{let{characterId:t}=e,{data:s,refetch:r,isFetching:n}=i.h.moderation.characterSafety.useQuery({externalId:t});return(0,a.jsxs)("div",{className:"flex items-center pl-4 gap-7",children:[(0,a.jsx)("div",{className:"w-4 ml-1",children:(0,a.jsx)(u.kUi,{className:"size-4"})}),(0,a.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,a.jsx)("p",{className:"text-md",children:n?"loading...":s}),(0,a.jsx)(o.S,{characterId:t,onAction:()=>r(),disabled:!s})]})]})};var c=s(76727),h=s(91262),m=s(22094),x=s(566),f=s(9949),v=s(17063),p=s(19206),g=s(53645),j=s(21805),b=s(82876),N=s(2784),w=s(1553),y=s(46175);let C="model_server_address";function S(e){let{characterId:t}=e,{isStaff:s}=(0,x.a)();return s?(0,a.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,a.jsx)(c.Z,{}),(0,a.jsx)(A,{}),(0,a.jsx)(d,{characterId:t}),(0,a.jsx)(D,{})]}):null}let M=()=>{let e=(0,b.useSearchParams)(),{addOrUpdateQueryParams:t,removeQueryParam:s}=(0,f.f)(),a=j.Z.get(p.Ls),r=null==e?void 0:e.get(C),n=null==e?void 0:e.get("neo_host");(0,N.useEffect)(()=>{n&&(0,g.e3)(n)},[n]);let[l,i]=(0,N.useState)(null!=r?r:a),[o,u]=(0,N.useState)(a&&r&&a!==r),d=(0,N.useCallback)(()=>{l&&(j.Z.set(p.Ls,l),u(!1))},[l]),c=(0,N.useCallback)(()=>{(0,m.K)("Model Server URL Override Cookie Cleared"),i(void 0),j.Z.remove(p.Ls),s(C),(0,g.yi)({modelServerURLOverride:void 0})},[s]);return(0,N.useEffect)(()=>{l&&(0,g.GY)(l)},[l]),(0,N.useEffect)(()=>{r&&r!==a?d():!r&&a&&t({[C]:a})},[t,a,d,r]),{persistModelServerURL:d,clearModelServerURL:c,modelServerOverride:l,queryDiffersFromCookie:o}};function _(){let{isStaff:e}=(0,x.a)();return e?(0,a.jsx)(R,{}):null}function R(){let{modelServerOverride:e,clearModelServerURL:t}=M();return e?(0,a.jsxs)("div",{className:"border-2 font-mono text-sm text-muted-foreground p-1 w-full justify-center flex rounded-spacing-xs border-yellow-400/80 border-dashed items-center",children:[(0,a.jsx)("div",{className:"flex gap-2",children:"model server override: ".concat(e)}),(0,a.jsx)("div",{className:"flex items-center justify-between ml-4",children:(0,a.jsx)(l.zx,{variant:"outline",className:"w-32 rounded-spacing-xs text-xs h-6",onPress:t,children:"Clear Override"})})]}):null}function A(){let e=(0,n.BF)(r.AR);return(0,a.jsxs)(l.zx,{variant:"ghost",className:"flex justify-between gap-3 font-mono text-sm w-full rounded-spacing-xs",onPress:()=>{(0,m.K)(e?"Debug mode disabled. Debug info will no longer be attached to new messages.":"Debug mode enabled. New messages should have debug info attached."),e||(0,g.e3)("neo-prod.characterai.dev"),(0,g.yD)(!e),r.AR.value=!e},children:[(0,a.jsx)(u.tvD,{className:(0,v.cn)("ml-1 size-4",{"text-muted-foreground":!e,"text-green-500":e})}),(0,a.jsx)(y.j,{className:"text-muted-foreground",phrases:[e?"{ disable debug stats }":"{ enable debug stats }"]})]})}function D(){let{hermesGenerationEnabled:e,hermesGenerationTemplate:t}=(0,g.$K)(),[s,r]=(0,N.useState)(null!=t?t:""),n=(null!=t?t:"")!==s,[,i]=(0,N.useState)(0),o=()=>i(e=>e+1);return(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsxs)(l.zx,{variant:"ghost",className:"flex justify-between gap-3 font-mono text-sm w-full rounded-spacing-xs",onPress:()=>{(0,g.yi)({hermesGenerationEnabled:!e}),o()},children:[(0,a.jsx)(w.wJk,{className:(0,v.cn)("ml-1 size-4",{"text-muted-foreground":!e,"text-yellow-400":e})}),(0,a.jsx)("div",{className:"text-muted-foreground",children:e?"{ disable hermes templates }":"{ enable hermes templates }"})]}),!!e&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.g,{className:"text-[10px] font-mono border-none bg-surface-elevation-1 p-1 resize-y overflow-x-scroll max-h-64 rounded-none",inputMode:"text",placeholder:"{% template %}",wrap:"off",onChange:e=>r(e.target.value),value:s}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(l.zx,{variant:"outline",className:"w-32 rounded-spacing-xs",isDisabled:!n,onPress:()=>{(0,g.yi)({hermesGenerationTemplate:s}),o()},children:"Save"}),!!t&&(0,a.jsx)("div",{className:"font-mono text-sm text-center",children:"template applied"})]})]})]})}},46175:function(e,t,s){s.d(t,{j:function(){return l}});var a=s(52322),r=s(2784);class n{setText(e){let t=this.el.innerText,s=Math.max(t.length,e.length),a=new Promise(e=>this.resolve=e);this.queue=[];for(let a=0;a<s;a++){let s=t[a]||"",r=e[a]||"",n=Math.floor(40*Math.random()),l=n+Math.floor(40*Math.random());this.queue.push({from:s,to:r,start:n,end:l})}return cancelAnimationFrame(this.frameRequest),this.frame=0,this.update(),a}update(){let e="",t=0;for(let s=0,a=this.queue.length;s<a;s++){let a=this.queue[s];if(null==a)continue;let{from:r,to:n,start:l,end:i}=a,{char:o}=a;this.frame>=i?(t++,e+=n):this.frame>=l?((!o||.28>Math.random())&&(o=this.randomChar(),this.queue[s].char=o),e+='<span class="text-muted-foreground">'.concat(o,"</span>")):e+=r}this.el.innerHTML=e,t===this.queue.length?this.resolve({}):(this.frameRequest=requestAnimationFrame(this.update),this.frame++)}randomChar(){return this.chars[Math.floor(Math.random()*this.chars.length)]}constructor(e){this.el=e,this.chars="!<>-_\\/[]{}â€”=+*^?#________",this.update=this.update.bind(this),this.frameRequest=0,this.queue=[],this.frame=0,this.resolve=()=>{}}}function l(e){let{phrases:t,className:s="",autoInterval:l=0}=e,i=(0,r.useRef)(null),o=(0,r.useRef)(),u=(0,r.useRef)(),[d,c]=(0,r.useState)(0);return(0,r.useEffect)(()=>{if(clearTimeout(o.current),i.current){let e=new n(i.current);o.current=setTimeout(()=>{e.setText(t[d])},600)}return()=>clearTimeout(o.current)},[t,d]),(0,r.useEffect)(()=>{l&&(u.current=setInterval(()=>{c((d+1)%t.length)},l))},[l,d,t.length]),(0,a.jsx)("div",{className:s,ref:i,onMouseEnter:()=>{c((d+1)%t.length)}})}},82427:function(e,t,s){s.d(t,{S:function(){return x}});var a,r,n=s(52322),l=s(76193),i=s(90122),o=s(23279),u=s(47843),d=s(17380),c=s(2784);(a=r||(r={})).REINSTATE="reinstate",a.DEMOTE="demote",a.NO_SHARING="no-sharing",a.DMCA="dmca",a.REVERT_DMCA="revert-dmca";let h={reinstate:"Reinstate",demote:"Demote","no-sharing":"No Sharing",dmca:"DMCA","revert-dmca":"Revert DMCA"},m=e=>{let{action:t,onSubmit:s,portalContainer:a,disabled:r}=e,[l,i]=(0,c.useState)(!1),[d,m]=(0,c.useState)(void 0);return(0,n.jsxs)(u.Vq,{open:l,onOpenChange:i,children:[(0,n.jsx)(u.hg,{asChild:!0,children:(0,n.jsx)(o.zx,{variant:"ghost",className:"flex justify-start rounded-spacing-xs hover:bg-danger text-sm w-full",isDisabled:r,children:h[t]})}),(0,n.jsxs)(u.cZ,{portalContainer:a,children:[(0,n.jsxs)(u.fK,{children:[(0,n.jsxs)(u.$N,{children:["Take Action: ",h[t]]}),(0,n.jsx)(u.Be,{className:"text-md pt-1",children:"Are you sure you want to take this action?"})]}),"revert-dmca"===t&&(0,n.jsx)("input",{className:"w-[440px] px-2 py-2",type:"number",value:d||"",placeholder:"input previous user id",onChange:e=>m(e.target.value)}),(0,n.jsx)(u.cN,{children:(0,n.jsx)(u.GG,{asChild:!0,children:(0,n.jsx)(o.zx,{className:"mt-1",variant:"primary",onPress:()=>{"revert-dmca"===t?s(parseInt(d||"",10)):s()},isDisabled:"revert-dmca"===t&&!(null==d?void 0:d.trim()),children:"Submit"})})})]})]})},x=e=>{let{characterId:t,onAction:s,disabled:a,showRevert:u=!1}=e,[h,x]=(0,c.useState)(!1),{mutateAsync:f}=d.h.moderation.moderateCharacter.useMutation(),v=Object.values(r).filter(e=>"revert-dmca"!==e||u).map(e=>({content:(0,n.jsx)(m,{action:e,onSubmit:async a=>{await f({externalId:t,action:e,..."revert-dmca"===e&&a?{charPrevUserId:a}:{}}),s()},disabled:a}),asChild:!0,key:e}));return(0,n.jsx)(l.C,{options:v,isOpen:h,setIsOpen:x,contentClassName:"gap-1 w-40",align:"center",disabled:a,asChild:!0,children:(0,n.jsxs)(o.zx,{className:"h-8",isDisabled:a,onPress:()=>x(!h),children:["Take Action",(0,n.jsx)(i.v4,{height:"16px"})]})})}}}]);